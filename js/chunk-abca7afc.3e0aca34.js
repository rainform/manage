(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-abca7afc"],{"84a4":function(e,t,r){"use strict";r("e724")},a15b:function(e,t,r){"use strict";var n=r("23e7"),s=r("44ad"),i=r("fc6a"),a=r("a640"),o=[].join,c=s!=Object,l=a("join",",");n({target:"Array",proto:!0,forced:c||!l},{join:function(e){return o.call(i(this),void 0===e?",":e)}})},d4c7:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"OverprintPage"},[r("h2",[e._v("套印工作區")]),r("div",{staticClass:"container"},[r("div",{staticClass:"card col-3 mx-2"},[r("div",{staticClass:"card-body"},[r("h3",{staticClass:"card-title"},[e._v(" 長生錄 ")]),r("p",{staticClass:"card-text"},[e._v(" 數量：共"+e._s(e.longevityList.length)+"份 ")]),r("button",{staticClass:"btn btn-primary",on:{click:function(t){return t.preventDefault(),e.mergeLongevity(t)}}},[e._v(" 套印長生錄 ")])])]),r("div",{staticClass:"card col-3 mx-2"},[r("div",{staticClass:"card-body"},[r("h3",{staticClass:"card-title"},[e._v(" 往生蓮位 ")]),r("p",{staticClass:"card-text"},[e._v(" 數量：共"+e._s(e.prayForList.length)+"份 ")]),r("button",{staticClass:"btn btn-primary",on:{click:function(t){return t.preventDefault(),e.mergePray(t)}}},[e._v(" 套印往生蓮位 ")])])]),r("div",{staticClass:"card col-3 mx-2"},[r("div",{staticClass:"card-body"},[r("h3",{staticClass:"card-title"},[e._v(" 郵寄封面 ")]),r("p",{staticClass:"card-text"},[e._v(" 數量：共"+e._s(e.letterList.length)+"份 ")]),r("button",{staticClass:"btn btn-primary",on:{click:function(t){return t.preventDefault(),e.mergeLetter(t)}}},[e._v(" 套印郵寄封面 ")])])])])])},s=[],i=(r("159b"),r("b0c0"),r("d3b7"),r("a15b"),r("99af"),r("3ca3"),r("ddb0"),r("9ab4")),a=r("c173");function o(e,t){return Object(i["a"])(this,void 0,Promise,(function(){var r,n,s,a,o;return Object(i["b"])(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,gapi.client.drive.files.copy({fileId:e,resource:{name:t}})];case 1:return r=i.sent(),n=r.result,s=n.name,a=n.id,console.log('Document "'+s+'" successfully found. with id '+a+"\n"),[2,a];case 2:throw o=i.sent(),console.log("Error: "+o.result.error.message),o;case 3:return[2]}}))}))}function c(e){return Object(i["a"])(this,void 0,Promise,(function(){var t,r,n;return Object(i["b"])(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),t={name:e,mimeType:"application/vnd.google-apps.folder"},[4,gapi.client.drive.files.create({resource:t,fields:"id"})];case 1:return r=s.sent(),[2,r.result.id];case 2:throw n=s.sent(),console.log("Error: "+n.result.error.message),n;case 3:return[2]}}))}))}function l(e,t){return Object(i["a"])(this,void 0,Promise,(function(){var r,n,s,a;return Object(i["b"])(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),[4,gapi.client.drive.files.get({fileId:e,fields:"parents"})];case 1:return r=i.sent(),n=r.result,s=n.parents.join(","),[4,gapi.client.drive.files.update({fileId:e,addParents:t,removeParents:s,fields:"id, parents"})];case 2:return i.sent(),[3,4];case 3:throw a=i.sent(),console.log("Error: "+a),a;case 4:return[2]}}))}))}function u(e){return e=e.replaceAll(/\s/gi,"\n"),e=e.replaceAll(/[{[(（]/gi,"︵"),e=e.replaceAll(/[)）}\]]/gi,"︶"),e=e.replaceAll(/./gi,"$&\n\n"),e=e.substring(0,e.length-2),e}var h=function(){function e(){}return e.merge=function(e){return Object(i["a"])(this,void 0,Promise,(function(){var t,r,n,s,o,l,u,h,d;return Object(i["b"])(this,(function(i){switch(i.label){case 0:return t=this,[4,c("長生祿位_"+(new Date).toLocaleString())];case 1:if(t.destinationFolderId=i.sent(),r=[],n=[],e.length%this.chunkSize!==0)for(s=this.chunkSize-e.length%this.chunkSize,o=0;o<s;o+=1)e.push(new a["c"](""));for(o=0;o<e.length;o+=1)l=this.format(e[o]),u=o%this.chunkSize+1,r=r.concat(this.buildRequest(u,l)),u===this.chunkSize&&(n.push(this.execute(r).catch((function(e){console.log("Error: "+e.result.error.message)}))),r=[]);i.label=2;case 2:return i.trys.push([2,4,,5]),[4,Promise.all(n)];case 3:return i.sent(),h=this.destinationFolderId,this.destinationFolderId=null,[2,h];case 4:throw d=i.sent(),console.log("Error: "+d.result.error.message),d;case 5:return[2]}}))}))},e.format=function(e){var t="",r="",n="",s=e.name,i=e.streamId;return s.length<=8?t=u(s):(r=u(s.substring(0,Math.ceil(s.length/2))),n=u(s.substring(Math.ceil(s.length/2)))),{shortTemplate:t,longTemplate1:r,longTemplate2:n,streamId:i}},e.buildRequest=function(e,t){var r=[];return r.push({replaceAllText:{containsText:{text:"{{名稱"+e+"short}}",matchCase:!0},replaceText:t.shortTemplate}}),r.push({replaceAllText:{containsText:{text:"{{名稱"+e+"long1}}",matchCase:!0},replaceText:t.longTemplate1}}),r.push({replaceAllText:{containsText:{text:"{{名稱"+e+"long2}}",matchCase:!0},replaceText:t.longTemplate2}}),r.push({replaceAllText:{containsText:{text:"{{stream"+e+"}}",matchCase:!0},replaceText:t.streamId}}),r},e.execute=function(e){return Object(i["a"])(this,void 0,void 0,(function(){var t;return Object(i["b"])(this,(function(r){switch(r.label){case 0:if(!this.destinationFolderId)throw new Error("Destination Folder undefine.");return[4,o(this.templateId,this.copyFilePrefix+"_"+Date.now())];case 1:return t=r.sent(),[4,l(t,this.destinationFolderId)];case 2:return r.sent(),[2,gapi.client.slides.presentations.batchUpdate({presentationId:t,resource:{requests:e}})]}}))}))},e.templateId="15kt5sHV7taVXOgM2VfyEDr2JGdNLmHrQvPvhU7QbPs4",e.chunkSize=4,e.destinationFolderId=null,e.copyFilePrefix="長生祿位",e}(),d=function(){function e(){}return e.merge=function(e){return Object(i["a"])(this,void 0,Promise,(function(){var t,r,n,s,o,l,u,h,d;return Object(i["b"])(this,(function(i){switch(i.label){case 0:return t=this,[4,c("往生蓮位_"+(new Date).toLocaleString())];case 1:if(t.destinationFolderId=i.sent(),r=[],n=[],e.length%this.chunkSize!==0)for(s=this.chunkSize-e.length%this.chunkSize,o=0;o<s;o+=1)e.push(new a["e"]("","","",""));for(o=0;o<e.length;o+=1)l=this.format(e[o]),u=o%this.chunkSize+1,r=r.concat(this.buildRequest(u,l)),u===this.chunkSize&&(n.push(this.execute(r).catch((function(e){console.log("Error: "+e.result.error.message)}))),r=[]);i.label=2;case 2:return i.trys.push([2,4,,5]),[4,Promise.all(n)];case 3:return i.sent(),h=this.destinationFolderId,this.destinationFolderId=null,[2,h];case 4:throw d=i.sent(),console.log("Error: "+d.result.error.message),d;case 5:return[2]}}))}))},e.format=function(e){var t="",r="",n="",s=e.prayType,i=e.prayDetail,a=e.registerName,o=e.streamId;return s.length<=8?t=u(s):(r=u(s.substring(0,Math.ceil(s.length/2))),n=u(s.substring(Math.ceil(s.length/2)))),{shortTemplate:t,longTemplate1:r,longTemplate2:n,streamId:o,registerName:u(a),prayDetail:u(i)}},e.buildRequest=function(e,t){var r=[];return r.push({replaceAllText:{containsText:{text:"{{名稱"+e+"short}}",matchCase:!0},replaceText:t.shortTemplate}}),r.push({replaceAllText:{containsText:{text:"{{名稱"+e+"long1}}",matchCase:!0},replaceText:t.longTemplate1}}),r.push({replaceAllText:{containsText:{text:"{{名稱"+e+"long2}}",matchCase:!0},replaceText:t.longTemplate2}}),r.push({replaceAllText:{containsText:{text:"{{stream"+e+"}}",matchCase:!0},replaceText:t.streamId}}),r.push({replaceAllText:{containsText:{text:"{{報恩人"+e+"}}",matchCase:!0},replaceText:t.registerName}}),r.push({replaceAllText:{containsText:{text:"{{細項"+e+"}}",matchCase:!0},replaceText:t.prayDetail}}),r},e.execute=function(e){return Object(i["a"])(this,void 0,void 0,(function(){var t;return Object(i["b"])(this,(function(r){switch(r.label){case 0:if(!this.destinationFolderId)throw new Error("Destination Folder undefine.");return[4,o(this.templateId,this.copyFilePrefix+"_"+Date.now())];case 1:return t=r.sent(),[4,l(t,this.destinationFolderId)];case 2:return r.sent(),[2,gapi.client.slides.presentations.batchUpdate({presentationId:t,resource:{requests:e}})]}}))}))},e.templateId="176z-TV6UyIpDXrp-_NSgcSPLwzconBdr4iUonXqff1w",e.chunkSize=4,e.destinationFolderId=null,e.copyFilePrefix="往生蓮位",e}(),p=function(){function e(){}return e.merge=function(e){return Object(i["a"])(this,void 0,Promise,(function(){var t,r,n,s,a,o,l,u;return Object(i["b"])(this,(function(i){switch(i.label){case 0:return t=this,[4,c("郵寄封面_"+(new Date).toLocaleString())];case 1:for(t.destinationFolderId=i.sent(),r=[],n=[],s=0;s<e.length;s+=1)a=this.format(e[s]),o=s%this.chunkSize+1,r=r.concat(this.buildRequest(o,a)),o===this.chunkSize&&(n.push(this.execute(r).catch((function(e){console.log("Error: "+e.result.error.message)}))),r=[]);i.label=2;case 2:return i.trys.push([2,4,,5]),[4,Promise.all(n)];case 3:return i.sent(),l=this.destinationFolderId,this.destinationFolderId=null,[2,l];case 4:throw u=i.sent(),console.log("Error: "+u.result.error.message),u;case 5:return[2]}}))}))},e.format=function(e){return e},e.buildRequest=function(e,t){var r=[];return r.push({replaceAllText:{containsText:{text:"{{郵遞區號}}",matchCase:!0},replaceText:t.postcode}}),r.push({replaceAllText:{containsText:{text:"{{地址}}",matchCase:!0},replaceText:t.address}}),r.push({replaceAllText:{containsText:{text:"{{收件人}}",matchCase:!0},replaceText:t.name}}),r},e.execute=function(e){return Object(i["a"])(this,void 0,void 0,(function(){var t;return Object(i["b"])(this,(function(r){switch(r.label){case 0:if(!this.destinationFolderId)throw new Error("Destination Folder undefine.");return[4,o(this.templateId,this.copyFilePrefix+"_"+Date.now())];case 1:return t=r.sent(),[4,l(t,this.destinationFolderId)];case 2:return r.sent(),[2,gapi.client.docs.documents.batchUpdate({documentId:t,resource:{requests:e}})]}}))}))},e.templateId="1kx3tnsGZBuAVk0-qZZn2iv2lffD91QccElM5yTOAOQE",e.chunkSize=1,e.destinationFolderId=null,e.copyFilePrefix="郵寄封面",e}(),f=r("2b0e"),m=f["default"].extend({components:{},data:function(){return{}},computed:{membersList:function(){return this.$store.state.membersList},longevityList:function(){var e=[];return this.membersList.forEach((function(t){if(t.isSubmitted){var r=1;t.ceremonyForm.longevityBoards.forEach((function(n){a["c"].isEmpty(n)||(n.streamId=t.streamId+"_"+r,r+=1,e.push(n))}))}})),e},prayForList:function(){var e=[];return this.membersList.forEach((function(t){if(t.isSubmitted){var r=1;t.ceremonyForm.prayBoards.forEach((function(n){a["e"].isEmpty(n)||(n.streamId=t.streamId+"_"+r,r+=1,e.push(n),""===n.name&&console.log(t))}))}})),e},letterList:function(){var e=[];return this.membersList.forEach((function(t){"letter"===t.ceremonyForm.personalInformation.informMethod&&e.push(t.ceremonyForm.personalInformation)})),e}},methods:{mergeLongevity:function(){var e=this;this.$notify({type:"info",title:"執行套印長生錄位..."}),h.merge(this.longevityList).then((function(){e.$notify({type:"success",title:"套印長生錄位完成"})})).catch((function(t){e.$notify({type:"error",title:"套印長生錄位失敗"}),console.error(t)}))},mergePray:function(){var e=this;this.$notify({type:"info",title:"執行套印往生蓮位..."}),d.merge(this.prayForList).then((function(){e.$notify({type:"success",title:"套印往生蓮位完成"})})).catch((function(t){e.$notify({type:"error",title:"套印往生蓮位失敗"}),console.error(t)}))},mergeLetter:function(){var e=this;this.$notify({type:"info",title:"執行套印郵寄封面..."}),p.merge(this.letterList).then((function(){e.$notify({type:"success",title:"套印郵寄封面完成"})})).catch((function(t){e.$notify({type:"error",title:"套印郵寄封面失敗"}),console.error(t)}))}}}),g=m,b=(r("84a4"),r("2877")),v=Object(b["a"])(g,n,s,!1,null,"0a076aa4",null);t["default"]=v.exports},e724:function(e,t,r){}}]);
//# sourceMappingURL=chunk-abca7afc.3e0aca34.js.map