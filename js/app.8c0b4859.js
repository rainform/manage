(function(e){function t(t){for(var r,o,i=t[0],u=t[1],s=t[2],d=0,f=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&f.push(a[o][0]),a[o]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);h&&h(t);while(f.length)f.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,o=1;o<n.length;o++){var i=n[o];0!==a[i]&&(r=!1)}r&&(c.splice(t--,1),e=u(u.s=n[0]))}return e}var r={},o={app:0},a={app:0},c=[];function i(e){return u.p+"js/"+({}[e]||e)+"."+{"chunk-24377416":"028e5f84","chunk-26bdaf96":"ae580a7f","chunk-2d0c0d7f":"50cfaeae","chunk-35da7d5b":"85874d67","chunk-4cbbc4a3":"a74063b5","chunk-5605bd10":"788dc84c","chunk-22ba5cb0":"b3ab82a3","chunk-5c6b1280":"2aea9dea","chunk-56e7e61e":"1e915750","chunk-5f41d306":"5cb0fa82","chunk-78d52b57":"8adef27b","chunk-6dc111e3":"e35bb90e","chunk-7dae04c6":"feefe0cc","chunk-8f56a1aa":"2a156988","chunk-9a829778":"ed2ae8ac","chunk-abca7afc":"3e0aca34","chunk-cd0c27e6":"ea00f7e8","chunk-e8592832":"c1cbdf60"}[e]+".js"}function u(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n={"chunk-24377416":1,"chunk-26bdaf96":1,"chunk-35da7d5b":1,"chunk-4cbbc4a3":1,"chunk-22ba5cb0":1,"chunk-5c6b1280":1,"chunk-56e7e61e":1,"chunk-5f41d306":1,"chunk-78d52b57":1,"chunk-6dc111e3":1,"chunk-7dae04c6":1,"chunk-8f56a1aa":1,"chunk-9a829778":1,"chunk-abca7afc":1,"chunk-cd0c27e6":1,"chunk-e8592832":1};o[e]?t.push(o[e]):0!==o[e]&&n[e]&&t.push(o[e]=new Promise((function(t,n){for(var r="css/"+({}[e]||e)+"."+{"chunk-24377416":"8450ccce","chunk-26bdaf96":"7e8ad580","chunk-2d0c0d7f":"31d6cfe0","chunk-35da7d5b":"c287350b","chunk-4cbbc4a3":"273aeb42","chunk-5605bd10":"31d6cfe0","chunk-22ba5cb0":"b44152db","chunk-5c6b1280":"bca33402","chunk-56e7e61e":"ea86e6c2","chunk-5f41d306":"e073c563","chunk-78d52b57":"cdbf2e01","chunk-6dc111e3":"5ac4f34f","chunk-7dae04c6":"d36bcf4c","chunk-8f56a1aa":"032f9758","chunk-9a829778":"202bbf84","chunk-abca7afc":"673efd66","chunk-cd0c27e6":"8885dcea","chunk-e8592832":"58d2c28b"}[e]+".css",a=u.p+r,c=document.getElementsByTagName("link"),i=0;i<c.length;i++){var s=c[i],d=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(d===r||d===a))return t()}var f=document.getElementsByTagName("style");for(i=0;i<f.length;i++){s=f[i],d=s.getAttribute("data-href");if(d===r||d===a)return t()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=t,h.onerror=function(t){var r=t&&t.target&&t.target.src||a,c=new Error("Loading CSS chunk "+e+" failed.\n("+r+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=r,delete o[e],h.parentNode.removeChild(h),n(c)},h.href=a;var l=document.getElementsByTagName("head")[0];l.appendChild(h)})).then((function(){o[e]=0})));var r=a[e];if(0!==r)if(r)t.push(r[2]);else{var c=new Promise((function(t,n){r=a[e]=[t,n]}));t.push(r[2]=c);var s,d=document.createElement("script");d.charset="utf-8",d.timeout=120,u.nc&&d.setAttribute("nonce",u.nc),d.src=i(e);var f=new Error;s=function(t){d.onerror=d.onload=null,clearTimeout(h);var n=a[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;f.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",f.name="ChunkLoadError",f.type=r,f.request=o,n[1](f)}a[e]=void 0}};var h=setTimeout((function(){s({type:"timeout",target:d})}),12e4);d.onerror=d.onload=s,document.head.appendChild(d)}return Promise.all(t)},u.m=e,u.c=r,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)u.d(n,r,function(t){return e[t]}.bind(null,r));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/manage/",u.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],d=s.push.bind(s);s.push=t,s=s.slice();for(var f=0;f<s.length;f++)t(s[f]);var h=d;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},1:function(e,t){},"16f4":function(e,t,n){"use strict";n("d3b7");var r=n("9ab4"),o=n("77d6"),a=n("260b"),c=(n("e71f"),function(){function e(){}return e.save=function(e){return Object(r["a"])(this,void 0,Promise,(function(){var t,n;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return t=a["a"].firestore(),n="rainform",[4,t.collection("events").doc(n).set(o["a"].toObject(e))];case 1:return r.sent(),[2]}}))}))},e.retrieve=function(){return Object(r["a"])(this,void 0,Promise,(function(){var e,t,n,o;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return e=a["a"].firestore(),t="rainform",[4,e.collection("events").doc(t).get()];case 1:return n=r.sent(),o=n.data(),[2,o]}}))}))},e}());t["a"]=c},2472:function(e,t,n){"use strict";var r=n("9ab4"),o=n("260b"),a=(n("ea7b"),function(){function e(){}return e.init=function(t){e.clientConfig=t,gapi.load("client:auth2",e.initClient)},e.initClient=function(){var t=e.clientConfig,n=t.API_KEY,r=t.CLIENT_ID,o=t.SCOPES,a=t.DISCOVERY_DOCS;gapi.client.init({apiKey:n,clientId:r,scope:o,discoveryDocs:a}).then((function(){e.auth2=gapi.auth2.getAuthInstance(),e.auth2.isSignedIn.listen(e.updateSigninStatus),e.updateSigninStatus(e.auth2.isSignedIn.get())})).catch((function(){console.error("Google client init failed")}))},e.updateSigninStatus=function(t){return Object(r["a"])(this,void 0,void 0,(function(){var n,a;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return t?(console.log("signed in"),e.currentUser=e.auth2.currentUser.get(),n=e.currentUser.getAuthResponse(!0),a=o["a"].auth.GoogleAuthProvider.credential(n.id_token,n.access_token),[4,o["a"].auth().signInWithCredential(a)]):[3,2];case 1:return r.sent(),[3,4];case 2:return console.log("signed out"),[4,o["a"].auth().signOut()];case 3:r.sent(),r.label=4;case 4:return e.authChangedCallback(t),[2]}}))}))},e.onAuthStateChanged=function(t){e.authChangedCallback=t},e.signIn=function(){e.auth2?e.auth2.signIn():console.error("Google client not ready")},e.signOut=function(){e.auth2?e.auth2.signOut():console.error("Google client not ready")},e}());t["a"]=a},"5c0b":function(e,t,n){"use strict";n("9c0c")},"65de":function(e,t,n){"use strict";n("d3b7");var r=n("9ab4"),o=n("260b"),a=(n("ea7b"),function(){function e(){}return e.safeGetUser=function(){var e=o["a"].auth().currentUser;if(!e)throw new Error;return e},e}()),c=a,i=(n("e71f"),function(){function e(){}return e.isAdmin=function(){return Object(r["a"])(this,void 0,Promise,(function(){var e,t,n,a;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return e=o["a"].firestore(),t=c.safeGetUser(),[4,e.collection("users").doc(t.uid).get()];case 1:return n=r.sent(),a=n.data(),a?[2,a.isAdmin]:[2,!1]}}))}))},e}());t["a"]=i},"77d6":function(e,t,n){"use strict";n("2b3d"),n("d3b7"),n("3ca3"),n("ddb0");var r=n("acf9"),o=n.n(r),a=function(){function e(){}return e.toObject=function(e){return JSON.parse(JSON.stringify(e))},e.exportCsv=function(e,t){var n=o.a.encode(t,"BIG5"),r=new Blob([n],{type:"text/csv;charset=big5;"}),a=window.URL.createObjectURL(r),c=document.createElement("a");c.href=a,c.download=e,document.body.appendChild(c),c.click(),document.body.removeChild(c)},e}();t["a"]=a},"9c0c":function(e,t,n){},ad19:function(e,t,n){"use strict";n("d3b7"),n("d81d"),n("99af"),n("159b");var r=n("9ab4"),o=n("77d6"),a=n("c173"),c=n("260b"),i=(n("e71f"),n("ec26")),u=function(){function e(){}return e.list=function(){return Object(r["a"])(this,void 0,Promise,(function(){var e,t,n,o,a;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return e=c["a"].firestore(),[4,e.collection("forms").where("streamId",">",0).orderBy("streamId").get()];case 1:return t=r.sent(),[4,e.collection("forms").where("streamId","==",0).get()];case 2:return n=r.sent(),o=t.docs.map((function(e){return e.data()})),a=n.docs.map((function(e){return e.data()})),[2,o.concat(a)]}}))}))},e.listCeremonyAttendees=function(){return Object(r["a"])(this,void 0,Promise,(function(){var e,t,n;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return e=c["a"].firestore(),[4,e.collection("forms").where("isSubmitted","==",!0).orderBy("streamId").get()];case 1:return t=r.sent(),n=[],t.docs.forEach((function(e){var t=e.data(),r=t.ceremonyForm.attendInfoList;r&&r.forEach((function(e){e.timestamp=t.submitTime,n.push(e)}))})),[2,n]}}))}))},e.save=function(e){return Object(r["a"])(this,void 0,Promise,(function(){var t,n,a;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return t=c["a"].firestore(),""===e.formId&&(e.formId=Object(i["a"])()),e.streamId?[3,2]:(n=e,[4,this.getStreamId()]);case 1:n.streamId=r.sent(),r.label=2;case 2:return a=o["a"].toObject(e),[4,t.collection("forms").doc(e.formId).set(a)];case 3:return r.sent(),[2,e.formId]}}))}))},e.delete=function(e){return Object(r["a"])(this,void 0,Promise,(function(){var t;return Object(r["b"])(this,(function(n){return t=c["a"].firestore(),[2,t.collection("forms").doc(e).delete()]}))}))},e.resetForms=function(){return Object(r["a"])(this,void 0,Promise,(function(){var e,t,n,i,u;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return e=c["a"].firestore(),t=e.batch(),[4,e.collection("forms").get()];case 1:return n=r.sent(),i=o["a"].toObject(new a["a"]),n.docs.forEach((function(n){console.log("reset "+n.id);var r=e.collection("forms").doc(n.id);t.update(r,{isLastEventSubmitted:!0===n.data().isSubmitted,isSubmitted:!1,streamId:0,"ceremonyForm.attendInfoList":[i]})})),u=e.collection("variables").doc("form"),t.update(u,{streamCounter:0}),[4,t.commit()];case 2:return r.sent(),[2]}}))}))},e.getStreamId=function(){return Object(r["a"])(this,void 0,Promise,(function(){var e,t,n,o=this;return Object(r["b"])(this,(function(a){switch(a.label){case 0:return e=c["a"].firestore(),t=e.collection("variables").doc("form"),[4,e.runTransaction((function(e){return Object(r["a"])(o,void 0,void 0,(function(){var n,o,a;return Object(r["b"])(this,(function(r){switch(r.label){case 0:return[4,e.get(t)];case 1:if(n=r.sent(),o=n.data(),!o)throw new Error("variables.form not found");return a=o.streamCounter+1,[4,e.update(t,{streamCounter:a})];case 2:return r.sent(),[2,a]}}))}))}))];case 1:return n=a.sent(),[2,n]}}))}))},e}();t["a"]=u},c173:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return i}));n("b0c0");var r=function(){function e(e,t,n,r,o,a,c,i,u){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),void 0===r&&(r=""),void 0===o&&(o=""),void 0===a&&(a=""),void 0===c&&(c=""),void 0===i&&(i=""),void 0===u&&(u=""),this.name=e,this.postcode=t,this.address=n,this.phone=r,this.telephone=o,this.email=a,this.line=c,this.wechat=i,this.informMethod=u}return e}(),o=function(){function e(e){this.name=e,this.streamId=""}return e.isEmpty=function(e){return""===e.name},e}(),a=function(){function e(e,t,n,r){this.registerName=e,this.prayType=t,this.otherPrayType=n,this.prayDetail=r,this.streamId=""}return e.isEmpty=function(e){return""===e.registerName&&""===e.prayType&&""===e.otherPrayType&&""===e.prayDetail},e}(),c=function(){function e(e,t,n,r,o,a,c,i,u){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),void 0===r&&(r=""),void 0===o&&(o=""),void 0===a&&(a=""),void 0===c&&(c=""),void 0===i&&(i=""),void 0===u&&(u=""),this.name=e,this.gender=t,this.age=n,this.attendDate=r,this.attendTime=o,this.leaveDate=a,this.leaveTime=c,this.note=i,this.timestamp=u}return e}(),i=function(){function e(){this.personalInformation=new r,this.longevityBoards=[new o("")],this.prayBoards=[new a("","","","")],this.attendInfoList=[new c("","","","","","","","","")]}return e}()},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("9ab4"),o=n("2b0e"),a=n("bc3a"),c=n.n(a),i=n("2106"),u=n.n(i),s=n("9062"),d=n.n(s),f=(n("e40d"),n("4989"),n("f9e3"),n("260b")),h=(n("ea7b"),n("1881")),l=n.n(h),m=n("ee98"),b=n.n(m),p=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view"),n("notifications",{attrs:{position:"bottom left"}})],1)},v=[],g=(n("5c0b"),n("2877")),k={},y=Object(g["a"])(k,p,v,!1,null,null,null),w=y.exports,I=n("2f62"),O=n("feed");o["default"].use(I["a"]);var S=function(){return{homepageRoute:"/homepage/memberlist",membersList:[],attendeesList:[],confirmApplication:!1,checkedRepeatList:!1,form:new O["a"],signature:"",repeatFormList:[],memberInfo:{},eventFormStatus:"viewOnly",eventInfo:{}}},j=new I["a"].Store({state:S(),mutations:{updateMemberList:function(e,t){e.membersList=t},updateAttendeesList:function(e,t){e.attendeesList=t},updateConfirmApplication:function(e,t){e.confirmApplication=t},updateCheckedRepeatList:function(e,t){e.checkedRepeatList=t},updateRepeatList:function(e,t){e.repeatFormList=t},updateMemberInfo:function(e,t){e.memberInfo=t},updateMemberForm:function(e,t){e.form=t},updateLongevity:function(e,t){e.form.ceremonyForm.longevityBoards=t},updatePrayFor:function(e,t){e.form.ceremonyForm.prayBoards=t},updateAttendInfo:function(e,t){e.form.ceremonyForm.attendInfoList=t},updateIsLastEventSubmitted:function(e,t){e.form.isLastEventSubmitted=t},updateIsSubmitted:function(e,t){e.form.isSubmitted=t},updateSubmitTime:function(e,t){e.form.submitTime=t},updateSignature:function(e,t){e.form.signature=t},saveSignature:function(e,t){e.signature=t},updateEventInfo:function(e,t){e.eventInfo=t},updateEventFormStatus:function(e,t){e.eventFormStatus=t},resetState:function(e){Object.assign(e,S())}},actions:{},modules:{}}),C=(n("d3b7"),n("3ca3"),n("ddb0"),n("b0c0"),n("8c4f"));o["default"].use(C["a"]);var L=[{path:"/",name:"Login",component:function(){return n.e("chunk-26bdaf96").then(n.bind(null,"5fb4"))}},{path:"/homepage",name:"HomePage",component:function(){return n.e("chunk-4cbbc4a3").then(n.bind(null,"f4a9"))},children:[{path:"memberlist",name:"MemberList",component:function(){return Promise.all([n.e("chunk-5605bd10"),n.e("chunk-5c6b1280")]).then(n.bind(null,"d084"))}},{path:"viewMemberForm",name:"ViewMemberForm",component:function(){return n.e("chunk-24377416").then(n.bind(null,"07bf"))}},{path:"attendeesList",name:"AttendeesList",component:function(){return Promise.all([n.e("chunk-5605bd10"),n.e("chunk-22ba5cb0")]).then(n.bind(null,"93a6"))}},{path:"viewMemberInfo",name:"ViewMemberInfo",component:function(){return n.e("chunk-7dae04c6").then(n.bind(null,"04e3"))}},{path:"overprintpage",name:"OverprintPage",component:function(){return n.e("chunk-abca7afc").then(n.bind(null,"d4c7"))}},{path:"eventForm",name:"EventForm",component:function(){return n.e("chunk-9a829778").then(n.bind(null,"cc28"))}},{path:"ceremonyFormsPage",name:"CeremonyFormsPage",component:function(){return n.e("chunk-e8592832").then(n.bind(null,"f422"))},children:[{path:"textname",name:"TextName",component:function(){return n.e("chunk-cd0c27e6").then(n.bind(null,"7a4a"))}},{path:"personalInformation",name:"",component:function(){return n.e("chunk-56e7e61e").then(n.bind(null,"4ca4"))}},{path:"longevity",name:"Longevity",component:function(){return n.e("chunk-6dc111e3").then(n.bind(null,"97ec"))}},{path:"prayFor",name:"PrayFor",component:function(){return n.e("chunk-8f56a1aa").then(n.bind(null,"7cd1"))}},{path:"attendInfo",name:"AttendInfo",component:function(){return n.e("chunk-5f41d306").then(n.bind(null,"3f22"))}},{path:"checkForm",name:"CheckForm",component:function(){return Promise.all([n.e("chunk-5f41d306"),n.e("chunk-78d52b57")]).then(n.bind(null,"84a6"))}}]}]},{path:"/no-auth",name:"NoAuthorization",component:function(){return n.e("chunk-35da7d5b").then(n.bind(null,"ba61"))}},{path:"/dev",name:"Dev",component:function(){return n.e("chunk-2d0c0d7f").then(n.bind(null,"4409"))}}],P=new C["a"]({routes:L,linkActiveClass:"active"}),E=C["a"].prototype.push;C["a"].prototype.push=function(e){var t=this;return new Promise((function(n,r){E.call(t,e,(function(){n(t.currentRoute)}),(function(e){"NavigationDuplicated"===e.name?n(t.currentRoute):r(e)}))}))};var A=P,F=n("65de"),T=n("ad19"),_=n("2472"),B=n("16f4");o["default"].config.productionTip=!1,o["default"].use(u.a,c.a),o["default"].component("Loading",d.a),o["default"].use(l.a,{dialog:!0}),o["default"].use(b.a);var D={CLIENT_ID:"244947259-cfp288k999s6kfm415vsfcrve84ed6vl.apps.googleusercontent.com",API_KEY:"AIzaSyBWVvkkFXqZUQdoqbQ28Wv1vW2lkjHB2_0",SCOPES:"https://www.googleapis.com/auth/drive https://www.googleapis.com/auth/documents",DISCOVERY_DOCS:["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest","https://docs.googleapis.com/$discovery/rest?version=v1","https://slides.googleapis.com/$discovery/rest?version=v1"]},M={apiKey:"AIzaSyBWVvkkFXqZUQdoqbQ28Wv1vW2lkjHB2_0",authDomain:"rainform-d5375.firebaseapp.com",projectId:"rainform-d5375",storageBucket:"rainform-d5375.appspot.com",messagingSenderId:"244947259",appId:"1:244947259:web:5403facdd1c5885c7fff1e",measurementId:"G-FQ8P6Z4HV7"};o["default"].use(l.a,{dialog:!0}),new o["default"]({router:A,store:j,created:function(){var e=this;f["a"].initializeApp(M),f["a"].auth().languageCode="zh-TW",_["a"].init(D),_["a"].onAuthStateChanged((function(t){return Object(r["a"])(e,void 0,void 0,(function(){var e=this;return Object(r["b"])(this,(function(n){switch(n.label){case 0:return t?[4,F["a"].isAdmin()]:[3,2];case 1:return n.sent()?(T["a"].list().then((function(t){e.$store.commit("updateMemberList",t)})),T["a"].listCeremonyAttendees().then((function(t){e.$store.commit("updateAttendeesList",t)})),B["a"].retrieve().then((function(t){e.$store.commit("updateEventInfo",t)})),this.$router.push(this.$store.state.homepageRoute)):this.$router.push("/no-auth"),[3,3];case 2:this.$router.push("/"),this.$store.commit("resetState"),n.label=3;case 3:return[2]}}))}))}))},render:function(e){return e(w)}}).$mount("#app")},feed:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n("ec26"),o=n("c173"),a=function(){function e(){this.streamId=0,this.ceremonyForm=new o["b"],this.isLastEventSubmitted=!1,this.isSubmitted=!1,this.submitTime="",this.signature="",this.formId=Object(r["a"])()}return e}()}});
//# sourceMappingURL=app.8c0b4859.js.map